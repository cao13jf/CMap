net: SliceNet #  Parameters used for training.
net_params:
  in_channels: 1
  n_first: 32
  conv_channels: 128
  groups: 16
  norm: in #sync_bn
  out_class: 6

criterion: [attention_dice_loss]  # , attention_MSE_loss
criterion_weights: [1]
criterion_kwargs:
  weight_type: identity
  eps: 1e-5

dataset: Memb3DDataset
d_threshold: 20
d_uniform: False

seed: 1024
batch_size: 8
num_epochs: 20
save_freq: 5     # save every 50 epochs
valid_freq: 5   # validate every 10 epochs
start_iter: 0

opt: Adam
opt_params:
  lr: 5e-3
  weight_decay: 1e-5
  amsgrad: true

workers: 8

train_embryos: [170614plc1p1, 170704plc1p1]  # embryos used for training.
test_embryos: [181210plc1p2]  # embryos used for testing.
train_transforms: # for training No resize operation permitted
  Compose([
    RandCrop((128,128,128)),
    RandomRotation(10),
    RandomFlip(0),
    NumpyType((np.float32, np.int64, np.int64))
    ])
test_transforms: # for testing
  Compose([
    Pad([205, 285, 144]),
    Resize((208, 288, 144)),
    NumpyType((np.float32, np.int64)),
    ])
